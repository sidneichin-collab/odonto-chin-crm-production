{
  "query": "CREATE TABLE IF NOT EXISTS appointments (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  clinic_id INT NOT NULL,\n  patient_id INT NOT NULL,\n  treatment_id INT,\n  appointment_date DATE NOT NULL,\n  appointment_time TIME NOT NULL,\n  duration INT,\n  treatment_type ENUM('orthodontics', 'general_clinic', 'both') NOT NULL,\n  status ENUM('scheduled', 'confirmed', 'not_confirmed', 'completed', 'cancelled', 'rescheduling_pending') DEFAULT 'scheduled' NOT NULL,\n  reminder_sent TINYINT DEFAULT 0 NOT NULL,\n  reminder_sent_at TIMESTAMP NULL,\n  reminder_attempts INT DEFAULT 0 NOT NULL,\n  last_reminder_at TIMESTAMP NULL,\n  confirmed_at TIMESTAMP NULL,\n  created_by INT,\n  chair INT,\n  notes TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (clinic_id) REFERENCES clinics(id) ON DELETE CASCADE,\n  FOREIGN KEY (patient_id) REFERENCES patients(id) ON DELETE CASCADE,\n  FOREIGN KEY (treatment_id) REFERENCES treatments(id) ON DELETE SET NULL,\n  FOREIGN KEY (created_by) REFERENCES users(id) ON DELETE SET NULL\n);\n\nCREATE TABLE IF NOT EXISTS scheduled_reminders (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  appointment_id INT NOT NULL,\n  reminder_type ENUM(\n    '2_days_before_10h', '2_days_before_15h', '2_days_before_19h',\n    '1_day_before_7h', '1_day_before_8h', '1_day_before_10h',\n    '1_day_before_12h', '1_day_before_14h', '1_day_before_16h', '1_day_before_18h',\n    'day_of_7h', 'day_of_2h_before'\n  ) NOT NULL,\n  scheduled_time TIMESTAMP NOT NULL,\n  status ENUM('pending', 'sent', 'failed', 'cancelled') DEFAULT 'pending' NOT NULL,\n  sent_at TIMESTAMP NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (appointment_id) REFERENCES appointments(id) ON DELETE CASCADE,\n  INDEX idx_scheduled_time (scheduled_time),\n  INDEX idx_status (status)\n);\n\nSELECT 'Appointments and scheduled_reminders tables created' as result;",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 3dy73aS7obdDVgV.73116cb9d21b --database Xh2xRagQAoY5NjF5TC3DfV --execute CREATE TABLE IF NOT EXISTS appointments (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  clinic_id INT NOT NULL,\n  patient_id INT NOT NULL,\n  treatment_id INT,\n  appointment_date DATE NOT NULL,\n  appointment_time TIME NOT NULL,\n  duration INT,\n  treatment_type ENUM('orthodontics', 'general_clinic', 'both') NOT NULL,\n  status ENUM('scheduled', 'confirmed', 'not_confirmed', 'completed', 'cancelled', 'rescheduling_pending') DEFAULT 'scheduled' NOT NULL,\n  reminder_sent TINYINT DEFAULT 0 NOT NULL,\n  reminder_sent_at TIMESTAMP NULL,\n  reminder_attempts INT DEFAULT 0 NOT NULL,\n  last_reminder_at TIMESTAMP NULL,\n  confirmed_at TIMESTAMP NULL,\n  created_by INT,\n  chair INT,\n  notes TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  FOREIGN KEY (clinic_id) REFERENCES clinics(id) ON DELETE CASCADE,\n  FOREIGN KEY (patient_id) REFERENCES patients(id) ON DELETE CASCADE,\n  FOREIGN KEY (treatment_id) REFERENCES treatments(id) ON DELETE SET NULL,\n  FOREIGN KEY (created_by) REFERENCES users(id) ON DELETE SET NULL\n);\n\nCREATE TABLE IF NOT EXISTS scheduled_reminders (\n  id INT AUTO_INCREMENT PRIMARY KEY,\n  appointment_id INT NOT NULL,\n  reminder_type ENUM(\n    '2_days_before_10h', '2_days_before_15h', '2_days_before_19h',\n    '1_day_before_7h', '1_day_before_8h', '1_day_before_10h',\n    '1_day_before_12h', '1_day_before_14h', '1_day_before_16h', '1_day_before_18h',\n    'day_of_7h', 'day_of_2h_before'\n  ) NOT NULL,\n  scheduled_time TIMESTAMP NOT NULL,\n  status ENUM('pending', 'sent', 'failed', 'cancelled') DEFAULT 'pending' NOT NULL,\n  sent_at TIMESTAMP NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  FOREIGN KEY (appointment_id) REFERENCES appointments(id) ON DELETE CASCADE,\n  INDEX idx_scheduled_time (scheduled_time),\n  INDEX idx_status (status)\n);\n\nSELECT 'Appointments and scheduled_reminders tables created' as result;",
  "rows": [
    {
      "result": "Appointments and scheduled_reminders tables created"
    }
  ],
  "messages": [],
  "stdout": "result\nAppointments and scheduled_reminders tables created\n",
  "stderr": "",
  "execution_time_ms": 509
}